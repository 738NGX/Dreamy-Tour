<wxs module="util" src="../../utils/util.wxs"></wxs>
<!-- header class="custom-navbar" tabList="{{[]}}" / -->
<scroll-view class="scrollarea" style="height:100vh" scroll-y type="list">
  <view class="name-card">
    <view style="height:150rpx" />
    <t-avatar bordered image="{{currentUser.avatarUrl}}" size="150rpx" class="avatar-example" t-class-content="external-class-content">{{ currentUser.name[0] }}</t-avatar>
    <view class="name-card-username">{{currentUser.name}}</view>
    <view class="row">
      <t-tag size="small" variant="light-outline" theme="{{util.getUserGroupTagTheme(userGroup)}}">{{userGroup}}</t-tag>
      <view wx:if="{{currentUser.gender!='保密'}}" class="gender-icon" style="background-color:#{{currentUser.gender=='男'?'00a1d6':'ff548c'}};">
        <t-icon name="{{currentUser.gender=='男'?'gender-male':'gender-female'}}" size="24rpx" />
      </view>
      <view class="name-card-uid" bind:tap="copyUid">UID: {{currentUser.id}}</view>
    </view>
    <view class="name-card-uid" style="margin-top:20rpx;">{{currentUser.signature}}</view>
  </view>
  <scroll-view scroll-y type="list" class="user-main">
    <view class="user-container">
      <view>
        <t-input borderless disabled label="经验值">
          <t-button slot="suffix" theme="primary" variant="outline" size="small" bind:tap="signIn">点击签到</t-button>
        </t-input>
      </view>
      <t-progress style="margin: 0 30rpx 30rpx 30rpx;" theme="plump" color="{{ {  from: '#0052D9', to: '#48c6ef' } }}" label="{{expLabel}}" percentage="{{expPercentage}}" />
      <t-grid column="{{3}}">
        <t-grid-item t-class-image="image" text="每日签到" icon="assignment-checked">
          <text slot="description" style="margin-top:10rpx; color:rgba(0,0,0,0.4); font-size:22rpx;">每日签到经验+5/次</text>
        </t-grid-item>
        <t-grid-item t-class-image="image" text="参与频道讨论" icon="chat-checked">
          <text slot="description" style="margin-top:10rpx; color:rgba(0,0,0,0.4); font-size:22rpx;">发布帖子经验+10/次\n发布评论经验+3/次</text>
        </t-grid-item>
        <t-grid-item t-class-image="image" text="完成一次行程" icon="map-checked">
          <text slot="description" style="margin-top:10rpx; color:rgba(0,0,0,0.4); font-size:22rpx;">组织者经验+50/次\n参与者经验+20/次</text>
        </t-grid-item>
      </t-grid>
      <c-collapse header="个人信息">
        <t-input class="narrow-input" borderless disabled label="UID" value="{{currentUser.id}}">
          <t-button slot="suffix" theme="primary" variant="outline" size="small" bind:tap="copyUid">复制</t-button>
        </t-input>
        <t-input class="narrow-input" borderless disabled label="修改头像">
          <t-button slot="suffix" theme="primary" variant="outline" size="small" open-type="chooseAvatar" bind:chooseavatar="uploadAvater">选择</t-button>
        </t-input>
        <view class="narrow-input" style="font-size:32rpx; padding:10rpx;">
          <view style="margin-right:32rpx;">昵称</view>
          <input type="nickname" value="{{currentUser.name}}" maxlength="{{15}}" bindchange="handleNickNameChange" bindblur="handleNickNameBlur" placeholder-style="input-placeholder" bind:blur="handleNickNameChange" placeholder="请输入昵称" />
        </view>
        <view class="narrow-input" style="font-size:32rpx; padding:10rpx;">
          <view style="margin-right:32rpx;">性别</view>
          <t-radio-group bind:change="handleGenderChange" value="{{currentUser.gender}}" borderless>
            <t-radio style="margin-right:32rpx;" block="{{false}}" label="男" value="男" />
            <t-radio style="margin-right:32rpx;" block="{{false}}" label="女" value="女" />
            <t-radio style="margin-right:32rpx;" block="{{false}}" label="保密" value="保密" />
          </t-radio-group>
        </view>
        <t-input class="narrow-input" bind:blur="handleSignatureChange" label="签名" placeholder="请输入个性签名" maxlength="{{30}}" value="{{currentUser.signature}}" />
      </c-collapse>
      <c-collapse wx:if="{{isTestMode}}" header="切换演示账号">
        <t-cell class="narrow-cell" bind:click="changeTestUser" wx:for="{{testUserList}}" wx:key="id" title="{{item.name}}" data-index="{{item.id}}" arrow hover>
          <t-avatar slot="left-icon" image="{{item.avatarUrl}}" style="margin:10rpx 0rpx;" class="avatar-example" t-class-content="external-class-content" size="32px">{{ item.name[0] }}</t-avatar>
        </t-cell>
      </c-collapse>
      <c-collapse header="选项设置">
        <t-button theme="danger" style="width:100%;" bind:tap="quitLogin">退出登录</t-button>
      </c-collapse>
      <c-collapse header="关于我们">
        <t-cell left-icon="logo-github" class="narrow-cell" bordered="{{false}}" title="Github仓库地址" description="738NGX/Dreamy-Tour" hover arrow/>
        <t-cell left-icon="code" class="narrow-cell" bordered="{{false}}" title="开发者" />
        <t-grid column="{{3}}">
          <t-grid-item t-class-image="image" text="@738NGX" description="From SCAI, SUFE" image="https://avatars.githubusercontent.com/u/79038651?v=4"/>
          <t-grid-item t-class-image="image" text="@Franctoryer" description="From SCAI, SUFE" image="https://avatars.githubusercontent.com/u/131339494?v=4"/>
          <t-grid-item t-class-image="image" text="@Choihyobin111" description="From SCAI, SUFE" image="https://avatars.githubusercontent.com/u/179166711?v=4"/>
        </t-grid>
      </c-collapse>
    </view>
  </scroll-view>
</scroll-view>